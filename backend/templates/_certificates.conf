{% if certificate and certificate_id > 0 %}
{% if certificate.provider == "letsencrypt" %}
  # Certbot TLS
  ssl_certificate /data/tls/certbot/live/npm-{{ certificate_id }}/fullchain.pem;
  ssl_certificate_key /data/tls/certbot/live/npm-{{ certificate_id }}/privkey.pem;
  {% if env.ACME_OCSP_STAPLING == "true" %}
  ssl_stapling_file /data/tls/certbot/live/npm-{{ certificate_id }}.der;
  include conf.d/include/tls-ciphers.conf;
  {% else %}
  include conf.d/include/tls-ciphers-no-stapling.conf;
  {% endif %}
{% else %}
  # Custom TLS
  include conf.d/include/tls-ciphers-no-stapling.conf;
  ssl_certificate /data/tls/custom/npm-{{ certificate_id }}/fullchain.pem;
  ssl_certificate_key /data/tls/custom/npm-{{ certificate_id }}/privkey.pem;
{% endif %}
{% endif %}
