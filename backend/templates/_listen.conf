{% if env.DISABLE_HTTP == "false" %}
  listen {{ env.IPV4_BINDING }}:80;
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:80;{% endif %}
{% else %}
  listen unix:/run/nginx-{{ id }}.sock;
{% endif %}

{% if certificate and certificate_id > 0 %}
  listen {{ env.IPV4_BINDING }}:443 ssl;
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:443 ssl;{% endif %}

{% if env.DISABLE_H3_QUIC == "false" %}
  listen {{ env.IPV4_BINDING }}:443 quic;
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:443 quic;{% endif %}

{% if hsts_subdomains %}
  more_set_headers 'Alt-Svc: h3=":443"; ma=86400';
{% else %}
  more_clear_headers "Alt-Svc";
  http3 off;
{% endif %}
{% endif %}
{% endif %}
  server_name {{ domain_names | join: " " }};
