{% if env.DISABLE_HTTP == "false" %}
  listen {{ env.IPV4_BINDING }}:{{ env.HTTP_PORT }};
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:{{ env.HTTP_PORT }};{% endif %}
{% else %}
  listen unix:/run/nginx-{{ id }}.sock;
{% endif %}

{% if certificate and certificate_id > 0 %}
  listen {{ env.IPV4_BINDING }}:{{ env.HTTPS_PORT }} ssl;
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:{{ env.HTTPS_PORT }} ssl;{% endif %}

{% if env.DISABLE_H3_QUIC == "false" %}
  listen {{ env.IPV4_BINDING }}:{{ env.HTTPS_PORT }} quic;
  {% if env.DISABLE_IPV6 == "false" %}listen {{ env.IPV6_BINDING }}:{{ env.HTTPS_PORT }} quic;{% endif %}

{% if hsts_subdomains %}
  more_set_headers 'Alt-Svc: h3=":{{ env.HTTPS_PORT }}"; ma=86400';
{% else %}
  more_clear_headers "Alt-Svc";
  http3 off;
{% endif %}
{% endif %}
{% endif %}
  server_name {{ domain_names | join: " " }};
